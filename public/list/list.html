<!DOCTYPE html>
<html lang="zh">

	<head>
		<meta charset="UTF-8" />
		<title>Document</title>
		<link rel="stylesheet" type="text/css" href="css/public.css" />
		<link rel="stylesheet" type="text/css" href="css/list.css" />
	</head>

	<body>
		<div class="top">
			<p class="sp">
				<a href="javascript:;">ECSHOP 管理中心</a>
			</p>
			<span class="sp"> - 商品列表 </span>
			<img src="list/jnsy.png" alt="" />
			<span class="sub"><a href="###">添加新商品</a></span>
		</div>
		<div class="form_div">
			<form>
				<img style="width:26px;height: 22px;vertical-align: middle;" src="list/icon_search.gif" />
				<select class="sele_01" name="">
					<option value="">所有种类</option>
					<option value="">1</option>
					<option value="">2</option>
					<option value="">3</option>
					<option value="">4</option>
					<option value="">5</option>
				</select>
				<select class="sele_02" name="">
					<option value="">所有种类</option>
					<option value="">1</option>
					<option value="">2</option>
					<option value="">3</option>
					<option value="">4</option>
					<option value="">5</option>
				</select>
				<select class="sele_03" name="">
					<option value="">所有种类</option>
					<option value="">1</option>
					<option value="">2</option>
					<option value="">3</option>
					<option value="">4</option>
					<option value="">5</option>
				</select>
				关键字
				<input type="text" name="keyword" id="keyword" size="15">
				<input type="button" id="btn" value=" 搜索 " class="button">
				<div class="list_Div">
					<table class="ta" border="1" cellspacing="1" cellpadding="3">
						<tr>
							<th class="th_01">
								<input onclick="listTable.selectAll(this, &quot;checkboxes&quot;)" type="checkbox">
								<a href="javascript:" title="点击对列表排序">编号</a><img src="list/sort_desc.gif">
							</th>
							<th class="th_02">
								<a href="javascript:; " title="点击对列表排序">商品名称</a>
							</th>
							<th class="th_03">
								<a href="javascript:; ">货号</a>
							</th>
							<th class="th_04">
								<a href="javascript:; ">价格</a>
							</th>
							<th>
								<a href="javascript:; ">上架</a>
							</th>
							<th>
								<a href="javascript:; ">精品</a>
							</th>
							<th>
								<a href="javascript:; ">新品</a>
							</th>
							<th>
								<a href="javascript:; ">热销</a>
							</th>
							<th class="th_03">
								<a href="javascript:; ">推荐排序</a>
							</th>
							<th>
								<a href="javascript:; ">库存</a>
							</th>
							<th class="th_04">
								<a href="javascript:; ">虚拟销量</a>
							</th>
							<th class="th_05">操作</th>
						</tr>
						<!--<tr class="list_01" style="height:59px;">
							<td  style="background:#fff">
								<input name="checkboxes[]" value="134" type="checkbox">
								134
							</td>
							<td class="first-cell" style="color: red; background:#fff">
							<span  title="点击修改内容" style="">爱冕－白18K金钻石戒指</span>
							</td>
							<td style="background:#fff" align="center">
								<span>ECS000000</span>
								
							</td>
							<td style="background:#fff" align="center">
								<span title="点击修改内容" style="">7013.00
    </span>
							</td>
							<td style="background:#fff" align="center">
								<img src="list/yes.gif" >
							</td>
							<td style="background:#fff" align="center"><img src="list/yes.gif" >
							</td>
							<td style="background:#fff" align="center">
								<img src="list/no.gif">
							</td>
							<td style="background:#fff" align="center">
								<img src="list/yes.gif" >
							</td>
							<td style="background:#fff" align="center">
								<span class="px">1</span>
							</td>
							<td style="background:#fff" align="center">
							<span>97</span>
							</td>
							<td style="background:#fff" align="center">
								<span>0</span>
							</td>
							<td style="background:#fff" align="center">
								<a href="../goods.php?id=134" target="_blank" title="查看">
									<img src="list/icon_view.gif" width="21" height="21" border="0">
								</a>
								<a href="goods.php?act=edit&amp;goods_id=134&amp;extension_code=" title="编辑">
									<img src="list/icon_edit.gif" width="21" height="21" border="0">
								</a>
								<a href="goods.php?act=copy&amp;goods_id=134&amp;extension_code=" title="复制">
									<img src="list/icon_copy.gif" width="21" height="21" border="0">
								</a>
								<a href="javascript:;" onclick="listTable.remove(134, '您确实要把该商品放入回收站吗？')" title="回收站">
									<img src="list/icon_trash.gif" width="21" height="21" border="0">
								</a>
								<img src="list/empty.gif" width="21" height="21" border="0">
							</td>
						</tr>-->
					</table>
				</div>
				<table id="page-table" cellspacing="0">
					  <tbody>
					  	<tr>
					    <td style="background-color: rgb(255, 255, 255);" nowrap="true" align="right">
					         <!-- $Id: page.htm 14216 2008-03-10 02:27:21Z testyang $ -->
						  <div id="turn-page">
									总计 <span id="totalRecords">1</span>
								 个&nbsp;&nbsp;记录分为 <span id="totalPages">1</span>
								  页&nbsp;&nbsp;当前第 <span id="pageCurrent">1</span>
								   页，每页 <input size="3" id="pageSize" value="1"  type="text">
					        <span id="page-link">
					          <a class="first" href="javascript:;">第一页</a>
					          <a class="PageU" href="javascript:;">上一页</a>
					          <a class="PageD" href="javascript:;">下一页</a>
					          <a href="javascript:;">最末页</a>
					          <select id="gotoPage">
					            <option value="1">1</option>          
					          </select>
					        </span>
					      </div>
					    </td>
					  </tr>
					</tbody>
				</table>
				<div id="footer">
共执行 7 个查询，用时 0.023354 秒，Gzip 已禁用，内存占用 3.537 MB<br>
版权所有 © 2005-2018 上海商派软件有限公司，并保留所有权利。</div>
			</form>
		</div>
	</body>
	<script type="text/javascript" src="../js/jquery-1.11.3.js" ></script>
<script type="text/javascript">
	$("#pageSize").change(function() {
		$(".ta .list_01").remove();
		var perPageCnt = $("#pageSize").val();
		var pageNO ;
//		console.log(pageNO)
		var keyword = $("#keyword").val();
//		console.log($("#pageCurrent").html())
		console.log(perPageCnt)
		gain(perPageCnt, pageNO, keyword);
	})
	$("#btn").click(function() {
		$(".ta .list_01").remove();
		var perPageCnt = $("#pageSize").val(res.total);
		var pageNO = 1;
//		console.log(pageNO)
		var keyword = $("#keyword").val();
		console.log(keyword)
//		console.log($("#pageCurrent").html())
		console.log(perPageCnt)
		gain(perPageCnt, pageNO, keyword);
	})
	
	gain($("#pageSize").val(),1,$("#keyword").val());
	
	var page = 1;
	var num = $("#pageSize").val();
	$(".PageD").click(function() {
		$(".ta .list_01").remove();
		page >= $("#totalPages").html() ? (page ==	$("#totalPages").html() ? alert("最后一页") : "") : page++;
		$("#pageCurrent").html(page)
//		console.log(page)
		var num = $("#pageSize").val();
		gain(num, page, $("#keyword").val());
	})
	$(".PageU").click(function() {
		var newNum = $("#pageCurrent").html();
//		console.log(newNum)
		$(".ta .list_01").remove();
		newNum--;
		newNum <= 1 ? (newNum = 1 ? alert("第一页") : "") : newNum--;
		gain(num, newNum, $("#keyword").val());
	})
	
	
	

	function gain(perPageCnt,pageNO,keyword) {
		$.ajax({
			url:"/goods/api/gain",
			type:"post",
			data: {
				keyword: keyword,
				pageNO: pageNO,
				perPageCnt:perPageCnt
			},
			success: function(res) {
				$("#totalPages").html(Math.ceil( res.total / $("#pageSize").val() )) 
				$("#pageCurrent").html(pageNO)
				$("#totalRecords").html(res.total)
				
				var arr = res.data;
//				console.log(res);
//				console.log(arr);
				$.each(arr, function(index, value) {
//					console.log(value.goods_name_01)
//页数
//					console.log(value)
					
					$(".ta").append(`<tr class="list_01" style="height:59px;">
							<td class="th_01" style="background:#fff;">
								<input name="checkboxes[]" value="134" type="checkbox">
								<span>1</span>
							</td>
							<td class="first-cell th_02" style="color: red; background:#fff">
							<span title="点击修改内容" id="goodN" style="">${value.goods_name_01}</span>
							</td>
							<td class="th_03" style="background:#fff" align="center">
								<span id="goodI">${value.goods_sn}</span>
								
							</td>
							<td  class="th_04" style="background:#fff" align="center">
								<span id="goodP" title="点击修改内容">${value.shop_price}
    </span>
							</td>
							<td style="background:#fff" align="center">
								<img src="list/yes.gif">
							</td>
							<td  class="th_06" style="background:#fff" align="center"><img src="list/yes.gif">
							</td>
							<td  class="th_07" style="background:#fff" align="center">
								<img src="list/no.gif">
							</td>
							<td  class="th_08" style="background:#fff" align="center">
								<img src="list/yes.gif">
							</td>
							<td style="background:#fff" align="center">
								<span id="goodST" class="px">${value.repertory}</span>
							</td>
							<td style="background:#fff" align="center">
							<span id="goodSK">${value.repertory}</span>
							</td>
							<td style="background:#fff" align="center">
								<span id="goodSL">${value.Simulation}</span>
							</td>
							<td style="background:#fff" align="center">
								<a href="javascript:;" target="_blank" title="查看">
									<img src="list/icon_view.gif" width="21" height="21" border="0">
								</a>
								<a href="javascript:;" id="edit"  title="编辑">
									<img src="list/icon_edit.gif" width="21" height="21" border="0">
								</a>
								<a href="javascript:;" title="复制">
									<img src="list/icon_copy.gif" width="21" height="21" border="0">
								</a>
								<a id="Del" href="javascript:;"  title="回收站">
									<img src="list/icon_trash.gif" width="21" height="21" border="0">
								</a>
							</td>
						</tr>`)
				})
				
			}
		});
	}
	
	$(".ta").on("click","#Del",function() {
		var goods_name = $("#Del").parent().parent().find(".th_02").children().html();
		console.log(goods_name)
		$.ajax({
			url:"/goods/api/updata",
			type:"post",
			data: {
				goods_name: goods_name
			},
			success: function(req,res) {
				console.log(res);
				if(res.code == 100) {
					alert(res.data)
				}
			}
		})
	})
	$(".ta").on("click", "#edit", function() {
		var goodN = $("#goodN").html();
		var goodI = $("#goodI").html();
		var goodP = $("#goodP").html();
		var goodST = $("#goodST").html();
		var goodSK = $("#goodSK").html();
		var goodSL = $("#goodSL").html();
		location.href = '../add/add.html?name='+ goodN + "&item=" + goodI + "&price=" + goodP + "&sort=" + goodST + "&stock=" + goodSK + "&sales=" + goodSL;
	})
	
</script>
</html>